<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<!--/*
  1. Variable Expressions           : ${...} (값을 나타낼 때 사용한다.)
  2. Selection Variable Expressions : *{...} (객체의 특정 필드 값을 나타낼 때 사용한다.)
  3. Message Expressions
  4. Link URL Expressions           : @{...} (경로 작성할 때 사용한다.)
  5. Fragment Expressions           : ~{...} (조각을 사용할 때 사용한다.)
*/-->

<!--/*
  ${name}             : request attribute      model.addAttribute("name", "킹콩")
                                               redirectAttributes.addFlashAttribute("name", "킹콩")
  ${param.name}       : request parameter      /board/detail.do?name=킹콩
  ${session.name}     : session attribute      session.setAttribute("name", "킹콩")
  ${application.name} : application attribute  servletContext.setAttribute("name", "킹콩")
*/-->

<!--/* 자바스크립트 내부에서 Variable Expression은 [[${}]]로 나타낸다. */-->

<!--/* /layout/header.html의 headFrag조각으로 head 태그를 바꾼다. */-->
<!-- <style>
.accordion-collapse {
  height: 0;
  
  /* 변화가 시작되는 쪽에다가 transition 적용해준다 0 -> 300px 
  왜? 닫기 버튼을 누를 때 변화가 티남 */
  transition: all 1s;
  
  
}

.active {
  display: block;
  /* 높이를 정해줘야지만 transition이 적용됨 */
  height: 200px;
}
</style> -->
<head th:replace="~{/layout/header::headFrag('고객센터')}"></head>
<body>
  <!--/* /layout/header.html의 gnbFrag조각으로 div 태그를 바꾼다. */-->
  <div th:replace="~{/layout/header::gnbFrag}"></div>
  
  <main>
    <header>
      <span class="text-muted pl-7" th:text="|HOME > 고객센터 >|"></span>
      <span class="text-dark" th:text="|자주묻는질문|"></span>
      <h1 class="text-center font-weight-bold pt-5">자주 묻는 질문</h1>
    </header>

    <section class="pt-5 pl-7">
      <div style="float: left; width: 15%;">
        <aside  class="align-items-center" >
          <h3 style="display:none;">서브메뉴</h3>
            <ul>
              <li id="notice">
                <a th:href="@{/customerCenter/notice.html}">공지사항</a>
              </li>
              <li id="faq">
                <a th:href="@{/customerCenter/qna.html}">자주 묻는 질문</a>
              </li>
              <li id="myPersonalInquery">
                 <a th:href="@{/customerCenter/qna.html}">1:1 문의</a>
              </li>
              <li id="qna">
                <a href="/serviceCenter/qna">고객의 소리</a>
              </li>
            </ul>
            <div >
              <span>고객센터<strong>1800-0700</strong></span>
              <p>평일, 토요일 7:00~18:00<br>공휴일 7시 ~ 13시 (일요일 휴무)</p>
            </div>
        </aside>
      </div>
      <div>
        <div class="body px-4 px-lg-5" style="float: left; width: 65%;">
          <div class="pd-r-68" >
            <div class="col-6">
              <form id="frm1" th:action="@{/customerCenter/faq.html}">
                <select name="searchColumn" id="searchColumn" class="blind">
                  <option value="">모든검색</option>
                  <option value="FAQ_CATEGORY">카테고리</option>
                </select>
                <div class="input-group mb-3">
                  <input class="form-control" list="auto_complete" type="text" name="query" id="query" placeholder="검색어를 입력하세요" aria-describedby="button-addon2">
                  <datalist id="auto_complete"></datalist>
                  <button class="btn btn-outline-success">조회</button>
                </div>
              </form>
            </div>
        
            <h3 class="blind">자주묻는질문카테고리</h3>
            <form id="frmKind" th:action="@{/customerCenter/faq.html}">
              <div class="btn-group mb-5 pl-13 " role="group" aria-label="Basic radio toggle button group">
                
                <input value="" type="radio" class="btn-check" name="kind" id="btnradio1" autocomplete="off" checked="checked">
                <label class="btn btn-outline-success" for="btnradio1">전체</label>
              
                <input value="상품" type="radio" class="btn-check" name="kind" id="btnradio2" autocomplete="off">
                <label class="btn btn-outline-success" for="btnradio2">상품</label>
              
                <input value="배송" type="radio" class="btn-check" name="kind" id="btnradio3" autocomplete="off">
                <label class="btn btn-outline-success" for="btnradio3">배송</label>
                
                <input value="회원정보" type="radio" class="btn-check" name="kind" id="btnradio4" autocomplete="off">
                <label class="btn btn-outline-success" for="btnradio4">회원정보</label>
                
                <input value="주문/결제" type="radio" class="btn-check" name="kind" id="btnradio5" autocomplete="off">
                <label class="btn btn-outline-success" for="btnradio5">주문/결제</label>
                
                <input value="취소/교환/반품" type="radio" class="btn-check" name="kind" id="btnradio6" autocomplete="off">
                <label class="btn btn-outline-success" for="btnradio6">취소/교환/반품</label>
                
              </div>
            </form>
          </div>
       
        
        
          <div class="subcontent pl-12 py-3" >
            <div id="totalRecord" th:text="|게시글 갯수: ${totalRecord}|"></div>
   
            <div class="pl-37">페이지보기
              <select id="recordPerPage">
                <option th:value="10">10개</option>
                <option th:value="20">20개</option>
                <option th:value="30">30개</option>
              </select> 
            </div>
          </div>

          <div>
            <table class="table">
              <thead class="text-center text-black">
                <tr>
                  <th scope="col" data-column="FAQ_NO" data-order="${order}">번호</th>
                  <th scope="col" data-column="FAQ_CATEGORY" data-order="${order}">카테고리</th>
                  <th scope="col" th:text="|게시글 갯수: ${totalRecord}|" data-column="FAQ_TITLE" data-order="${order}">제목</th>
                </tr>
              </thead>
              <tbody th:id="faqListContainer" class="text-center text-black">
                <th:block th:if="${#lists.isEmpty(faqList)}">
                  <tr class="list">
                    <td colspan="3">게시글이 없습니다.</td>
                  </tr>
                </th:block>
                  
                <th:block th:if="${not #lists.isEmpty(faqList)}"> 
               
                  <th:block th:each="faq, vs:${faqList}" > 
                    <tr class="accordion accordion-flush" id="accordionFlushExample">
                      <td colspan="3">
                        <div  class="accordion-item">
                          <h2 class="accordion-header" th:id="|flush-heading${vs.index}|">         
                            <button id="btn-all-close" class="accordion-button collapsed" type="button" th:data-bs-toggle="collapse" th:data-bs-target="|#flush-collapse${vs.index}|" aria-expanded="false" th:aria-controls="|#flush-collapse${vs.index}|">
                              <em th:text="${beginNo - vs.index}"></em>
                              <em th:id="faqCategory" th:text="|&nbsp[${faq.faqCategory}]|"></em>
                              <span th:text="|&nbsp&nbsp&nbsp${faq.faqTitle}|"></span> 
                            </button>
                          </h2>
                            <div th:id="|flush-collapse${vs.index}|" class="accordion-collapse collapse" th:aria-labelledby="|flush-heading${vs.index}|" th:data-bs-parent="|#accordionFlushExample|">
                              <div class="accordion-body"><code th:text="${faq.faqContent}"></code></div>
                            </div>
                        </div>
                      </td>
                      <td>
                        <th:block th:if="${session.loginId != null and session.sellerChk == 2}">
                          <form class="frm_remove" method="post" th:action="@{/customerCenter/remove.do}">
                            <input type="hidden" name="faqNo" th:value="${faq.faqNo}">
                            <button>삭제</button>
                          </form>
                          <form class="frm_edit" th:action="@{/customerCenter/edit.html}">
                            <input type="hidden" name="faqNo" th:value="${faq.faqNo}">
                            <button>수정하기</button>
                          </form>
                        </th:block>
                      </td>
                    </tr>
                  </th:block>
                </th:block>
              </tbody>
            </table>
            <div th:utext="${pagination}"></div>
          </div>
          <th:block th:if="${session.loginId != null and session.sellerChk == 2}">
            <input  class="end"  type="button" value="새글 작성하기" onclick="fnNewWrite()">
          </th:block>
        </div>
      </div>
    </section>
  </main>
</body>
<script th:inline="javascript">


    // recordPerPage의 변경
    $('#recordPerPage').on('change', function(){
      location.href = '/customerCenter/change/record.do?recordPerPage=' + $(this).val();  // session에 recorePerPage 올리기
    });
    
    // 세션에 저장된 recordPerPage값으로 <select> 태그의 값을 세팅
    var recordPerPage = /*[[${session.recordPerPage}]]*/ '';
    
    recordPerPage = recordPerPage == '' ? '10' : recordPerPage;
    $('#recordPerPage').val(recordPerPage);
    
    
    
function fnNewWrite() {
    location.href='/customerCenter/write.html';
  }

$(function() {
	  // 라디오 버튼 클릭 이벤트 처리
	  $('input[name="kind"]').on('click', function fnKindChange() {
	    $('#frmKind').submit();
	  });
	});
	
window.onload = () => {
	  const panelFaqContainer = document.querySelectorAll(".accordion-item");
	  const accordion = document.querySelectorAll(".accordion");
	  const panelFaqAnswer = document.querySelectorAll(".accordion-collapse");
	  const btnAllClose = document.querySelector("#btn-all-close");
	  let activeIndex = null; // Track the index of the currently active panel

	  for (let i = 0; i < accordion.length; i++) {
	    accordion[i].addEventListener('click', function() {
	      if (activeIndex !== i) {
	        // Close the previously active panel
	        if (activeIndex !== null) {
	          panelFaqContainer[activeIndex].classList.remove('active');
	        }
	        // Open the clicked panel
	        panelFaqContainer[i].classList.add('active');
	        activeIndex = i;
	      } else {
	        // Toggle the clicked panel
	        panelFaqContainer[i].classList.toggle('active');
	        activeIndex = null;
	      }
	    });
	  }

	  panelFaqAnswer.addEventListener('click', function() {
	    for (let i = 0; i < panelFaqContainer.length; i++) {
	      panelFaqContainer[i].classList.remove('active');
	    }
	    activeIndex = null;
	  });
	};
</script>
</html>